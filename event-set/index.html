<!DOCTYPE html>
<html>
<head>
<title>User activation event-set tester</title>
<style>
  #target {
    width: 400px;
    height: 5em;
    background-color: lightyellow;
    border: 2px solid green;
    padding: 5px;
  }
</style>
<script>
  const userAgentIsEdge = (navigator.userAgent.indexOf("Edge") >= 0);

  let eventList = [
    "#group mouse events",
    "auxclick",
    "click",
    "contextmenu",
    "dblclick",
    "mousedown",
    "mousemove",
    "mouseup",

    "#group pointer events",
    "pointerdown",
    "pointermove",
    "pointerup",

    "#group touch events",
    "touchend",
    "touchmove",
    "touchstart",

    "#group keyboard events",
    "keydown",
    "keypress",
    "keyup",

    "#group other events",
    "change",
    "compositionend",
    "compositionstart",
    "compositionupdate",
    "input",
    "reset",
    "submit",
  ];

  function $(id) {
      return document.getElementById(id);
  }

  function log(msg) {
    $("log").innerHTML += (msg + "<br> ");
  }

  function hasSelectedValue(selectElem, queryValue) {
    let selectedOptions = selectElem.selectedOptions;
    // JS for-each iterator doesn't work in Edge!
    for (let i = selectedOptions.length - 1; i >= 0; i--) {
      if (selectedOptions[i].value == queryValue)
        return true;
    }
    return false;
  }

  function callWindowOpen(label) {
    let link = "http://www.example.com/?label=" + label;
    let result = window.open(link);
    log("window.open on '" + label + "' " + (result ? "success" : "failure"));
  }

  function callNone(label) {
    log("no-op on '" + label + "'");
  }

  function init() {
    let optGroupElem = undefined;

    eventList.forEach(function(eventName) {
      if (eventName.startsWith("#group")) {
        if (!userAgentIsEdge) {
          optGroupElem = document.createElement("optgroup");
          optGroupElem.label = eventName.replace("#group ", "");
          $("select-event").add(optGroupElem, null);
        }

      } else {
        // Populate event option
        let eventOptionElem = document.createElement("option");
        eventOptionElem.value = eventOptionElem.text = eventName;
        if (!userAgentIsEdge)
          optGroupElem.appendChild(eventOptionElem);
        else
          $("select-event").add(eventOptionElem, null);

        // Add event listener
        $("target").addEventListener(eventName, function(e) {
          if (!hasSelectedValue($("select-event"), eventName))
            return;

          switch($("triggered-api").options[$("triggered-api").selectedIndex].value) {
            case "window.open":
              callWindowOpen(e.type);
              break;

            case "none":
              callNone(e.type);
              break;
          }
        });
      }
    });
  }
</script>
</head>
<body onload="init()">
  <p>
    <label>Test event(s):</label>
    <select id="select-event" multiple></select>
    &emsp;
    <label>Test API:</label>
    <select id="triggered-api">
      <option value="window.open">window.open</option>
      <option value="none">-none-</option>
    </select>
  </p>
  <p>
    <textarea id="target">
Trigger event here, through click/tap/swipe/keypress etc.

Trigger event here, through click/tap/swipe/keypress etc.

Trigger event here, through click/tap/swipe/keypress etc.
    </textarea>
  </p>
  <div id="log"><b>Log:</b><br></div>
</body>
</html>
